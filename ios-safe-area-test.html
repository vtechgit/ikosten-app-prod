<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>iOS Safe Area Test - iKosten</title>
  <style>
    /* Reset b√°sico */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f5;
    }

    /* Simulador de iPhone */
    .device-simulator {
      max-width: 400px;
      margin: 20px auto;
      background: #000;
      border-radius: 40px;
      padding: 15px;
      box-shadow: 0 10px 50px rgba(0,0,0,0.3);
    }

    .device-screen {
      background: #fff;
      border-radius: 30px;
      overflow: hidden;
      position: relative;
    }

    /* Notch/Dynamic Island simulator */
    .device-notch {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 30px;
      background: #000;
      border-radius: 0 0 20px 20px;
      z-index: 1000;
    }

    .device-notch.dynamic-island {
      width: 150px;
      height: 37px;
      border-radius: 20px;
      top: 10px;
    }

    /* Status bar */
    .status-bar {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 44px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      color: #000;
      font-size: 14px;
      font-weight: 500;
      z-index: 999;
      background: linear-gradient(180deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0) 100%);
    }

    /* BEFORE: Problema */
    .header-before {
      background: #3880ff;
      color: white;
      /* Sin padding-top en el header */
    }

    .toolbar-before {
      /* Padding aplicado al toolbar - PROBLEMA */
      padding-top: 44px;
      min-height: calc(56px + 44px);
      display: flex;
      align-items: center;
      padding-left: 16px;
      padding-right: 16px;
      position: relative;
    }

    /* AFTER: Soluci√≥n */
    .header-after {
      background: #3880ff;
      color: white;
      /* Padding aplicado al header - CORRECTO */
      padding-top: 44px;
    }

    .toolbar-after {
      /* Altura normal del toolbar */
      min-height: 56px;
      display: flex;
      align-items: center;
      padding-left: 16px;
      padding-right: 16px;
      position: relative;
    }

    /* Elementos del toolbar */
    .menu-button {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255,255,255,0.2);
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
      margin-right: 12px;
    }

    .menu-button:hover {
      background: rgba(255,255,255,0.3);
    }

    .menu-button:active {
      background: rgba(255,255,255,0.4);
    }

    .toolbar-title {
      flex: 1;
      font-size: 18px;
      font-weight: 600;
    }

    /* Contenido */
    .content {
      padding: 20px;
      min-height: 400px;
    }

    /* Controles */
    .controls {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .control-group {
      margin-bottom: 20px;
    }

    .control-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }

    select, button {
      padding: 10px 16px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      margin-right: 10px;
    }

    button {
      background: #3880ff;
      color: white;
      border: none;
      font-weight: 600;
      transition: background 0.3s;
    }

    button:hover {
      background: #2a5fc9;
    }

    .toggle-container {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .version-badge {
      display: inline-block;
      padding: 4px 12px;
      background: #e0e0e0;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 10px;
    }

    .version-badge.before {
      background: #ff5252;
      color: white;
    }

    .version-badge.after {
      background: #4caf50;
      color: white;
    }

    /* Overlay para mostrar el √°rea clickeable */
    .clickable-area {
      position: absolute;
      border: 2px dashed #4caf50;
      background: rgba(76, 175, 80, 0.1);
      pointer-events: none;
      z-index: 10;
    }

    /* Indicadores */
    .indicator {
      padding: 12px 20px;
      margin: 10px 0;
      border-radius: 8px;
      font-size: 14px;
    }

    .indicator.warning {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      color: #856404;
    }

    .indicator.success {
      background: #d4edda;
      border-left: 4px solid #28a745;
      color: #155724;
    }

    .indicator.info {
      background: #d1ecf1;
      border-left: 4px solid #17a2b8;
      color: #0c5460;
    }

    /* Medidas visuales */
    .measurement {
      position: absolute;
      background: rgba(255, 193, 7, 0.9);
      color: #000;
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: bold;
      z-index: 1001;
    }

    /* Comparaci√≥n lado a lado */
    .comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }

    .comparison-item {
      text-align: center;
    }

    .comparison-item h3 {
      margin-bottom: 10px;
      padding: 8px;
      border-radius: 8px;
      font-size: 16px;
    }

    .comparison-item h3.before {
      background: #ff5252;
      color: white;
    }

    .comparison-item h3.after {
      background: #4caf50;
      color: white;
    }

    @media (max-width: 768px) {
      .comparison {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="controls">
    <h1>üß™ iOS Safe Area Test - iKosten App</h1>
    
    <div class="indicator info">
      <strong>Prop√≥sito:</strong> Esta p√°gina te permite visualizar el problema del Safe Area en iOS y c√≥mo fue solucionado.
    </div>

    <div class="control-group">
      <label>Tipo de dispositivo:</label>
      <select id="deviceType" onchange="updateDevice()">
        <option value="notch">iPhone con Notch (X, 11, 12, 13, 14)</option>
        <option value="dynamic-island">iPhone con Dynamic Island (14 Pro, 15 Pro)</option>
        <option value="normal">iPhone sin Notch (SE)</option>
      </select>
    </div>

    <div class="control-group">
      <label>Mostrar √°reas clickeables:</label>
      <div class="toggle-container">
        <button onclick="toggleClickableAreas()">Toggle √Åreas Clickeables</button>
        <button onclick="toggleMeasurements()">Toggle Medidas</button>
      </div>
    </div>
  </div>

  <div class="comparison">
    <!-- BEFORE -->
    <div class="comparison-item">
      <h3 class="before">‚ùå ANTES (Problem√°tico)</h3>
      <div class="indicator warning">
        <strong>Problema:</strong> El menu-button queda bajo el status bar y es inaccesible.
      </div>
      
      <div class="device-simulator">
        <div class="device-screen">
          <div id="notch-before" class="device-notch"></div>
          <div class="status-bar">
            <span>12:00 PM</span>
            <span>üì∂ ‚óè‚óè‚óè‚óè</span>
          </div>
          
          <div class="header-before">
            <div class="toolbar-before" id="toolbar-before">
              <div class="menu-button" onclick="alert('¬°Menu button clicked! (BEFORE)')">‚ò∞</div>
              <div class="toolbar-title">Mis Recibos</div>
            </div>
          </div>
          
          <div class="content">
            <p><strong>Nota:</strong> El bot√≥n de men√∫ (‚ò∞) puede estar parcialmente oculto bajo el status bar.</p>
            <p>Padding aplicado: <code>toolbar { padding-top: 44px }</code></p>
          </div>
        </div>
      </div>
    </div>

    <!-- AFTER -->
    <div class="comparison-item">
      <h3 class="after">‚úÖ DESPU√âS (Correcto)</h3>
      <div class="indicator success">
        <strong>Soluci√≥n:</strong> El padding en el header empuja todo el toolbar correctamente hacia abajo.
      </div>
      
      <div class="device-simulator">
        <div class="device-screen">
          <div id="notch-after" class="device-notch"></div>
          <div class="status-bar">
            <span>12:00 PM</span>
            <span>üì∂ ‚óè‚óè‚óè‚óè</span>
          </div>
          
          <div class="header-after">
            <div class="toolbar-after" id="toolbar-after">
              <div class="menu-button" onclick="alert('¬°Menu button clicked! (AFTER)')">‚ò∞</div>
              <div class="toolbar-title">Mis Recibos</div>
            </div>
          </div>
          
          <div class="content">
            <p><strong>Nota:</strong> El bot√≥n de men√∫ (‚ò∞) est√° completamente visible y accesible.</p>
            <p>Padding aplicado: <code>header { padding-top: 44px }</code></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="controls" style="margin-top: 40px;">
    <h2>üìä Explicaci√≥n T√©cnica</h2>
    
    <div class="indicator info">
      <h4>Cambio Principal en global.scss:</h4>
      <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto; margin-top: 10px;">
// ANTES (‚ùå Problem√°tico)
.ios {
  ion-header {
    ion-toolbar {
      padding-top: env(safe-area-inset-top); // Padding en el toolbar
      min-height: calc(56px + env(safe-area-inset-top));
    }
  }
}

// DESPU√âS (‚úÖ Correcto)
.ios {
  ion-header {
    padding-top: env(safe-area-inset-top); // Padding en el header
    
    ion-toolbar {
      --min-height: 56px; // Altura normal
      min-height: 56px;
    }
  }
}</pre>
    </div>

    <div class="indicator success">
      <strong>Beneficios de la nueva implementaci√≥n:</strong>
      <ul style="margin-top: 10px; margin-left: 20px;">
        <li>‚úì Todos los elementos hijos (menu-button, title, buttons) son accesibles</li>
        <li>‚úì El c√≥digo es m√°s limpio y f√°cil de mantener</li>
        <li>‚úì Funciona correctamente en todos los dispositivos iOS</li>
        <li>‚úì Compatible con headers transl√∫cidos y modales</li>
      </ul>
    </div>

    <div class="indicator info">
      <strong>Archivos de referencia creados:</strong>
      <ul style="margin-top: 10px; margin-left: 20px;">
        <li>üìÑ <code>IOS_SAFE_AREA_FIX.md</code> - Documentaci√≥n completa del fix</li>
        <li>üìÑ <code>IOS_SAFE_AREA_VISUAL_GUIDE.css</code> - Gu√≠a visual con ejemplos</li>
        <li>üìÑ <code>ios-safe-area-test.html</code> - Esta p√°gina de prueba</li>
      </ul>
    </div>
  </div>

  <script>
    let showClickableAreas = false;
    let showMeasurements = false;

    function updateDevice() {
      const deviceType = document.getElementById('deviceType').value;
      const notchBefore = document.getElementById('notch-before');
      const notchAfter = document.getElementById('notch-after');
      
      // Remover clases existentes
      notchBefore.className = 'device-notch';
      notchAfter.className = 'device-notch';
      
      if (deviceType === 'dynamic-island') {
        notchBefore.classList.add('dynamic-island');
        notchAfter.classList.add('dynamic-island');
      } else if (deviceType === 'normal') {
        notchBefore.style.display = 'none';
        notchAfter.style.display = 'none';
      } else {
        notchBefore.style.display = 'block';
        notchAfter.style.display = 'block';
      }
    }

    function toggleClickableAreas() {
      showClickableAreas = !showClickableAreas;
      
      // Remover √°reas existentes
      document.querySelectorAll('.clickable-area').forEach(el => el.remove());
      
      if (showClickableAreas) {
        // Agregar √°reas clickeables
        const menuButtons = document.querySelectorAll('.menu-button');
        menuButtons.forEach(btn => {
          const rect = btn.getBoundingClientRect();
          const container = btn.closest('.device-screen');
          const containerRect = container.getBoundingClientRect();
          
          const overlay = document.createElement('div');
          overlay.className = 'clickable-area';
          overlay.style.top = (rect.top - containerRect.top) + 'px';
          overlay.style.left = (rect.left - containerRect.left) + 'px';
          overlay.style.width = rect.width + 'px';
          overlay.style.height = rect.height + 'px';
          overlay.style.position = 'absolute';
          
          container.appendChild(overlay);
        });
      }
    }

    function toggleMeasurements() {
      showMeasurements = !showMeasurements;
      
      // Remover medidas existentes
      document.querySelectorAll('.measurement').forEach(el => el.remove());
      
      if (showMeasurements) {
        // Agregar medidas
        const toolbarBefore = document.getElementById('toolbar-before');
        const toolbarAfter = document.getElementById('toolbar-after');
        
        addMeasurement(toolbarBefore, '44px safe area', 10, -25);
        addMeasurement(toolbarBefore, '100px total height', 10, 10);
        
        addMeasurement(toolbarAfter, '44px header padding', 10, -25);
        addMeasurement(toolbarAfter, '56px toolbar height', 10, 10);
      }
    }

    function addMeasurement(element, text, x, y) {
      const measurement = document.createElement('div');
      measurement.className = 'measurement';
      measurement.textContent = text;
      measurement.style.top = y + 'px';
      measurement.style.left = x + 'px';
      element.style.position = 'relative';
      element.appendChild(measurement);
    }

    // Inicializar
    updateDevice();
  </script>
</body>
</html>
